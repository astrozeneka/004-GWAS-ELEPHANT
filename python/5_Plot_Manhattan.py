
import matplotlib.pyplot as plt
import numpy as np

max_list ={'CM044036.1': 91463846, 'JAMZQU010000060.1': 1077329, 'CM044033.1': 100086523, 'CM044034.1': 96272385, 'CM044021.1': 236630106, 'CM044045.1': 48412177, 'JAMZQU010000061.1': 22713, 'CM044023.1': 197250280, 'JAMZQU010000004.1': 2560509, 'CM044024.1': 166427164, 'JAMZQU010000026.1': 1702350, 'CM044025.1': 144989373, 'CM044037.1': 84747581, 'JAMZQU010000039.1': 4389825, 'JAMZQU010000034.1': 2387672, 'JAMZQU010000025.1': 2681847, 'CM044032.1': 106004029, 'CM044038.1': 85774129, 'JAMZQU010000054.1': 4824, 'JAMZQU010000012.1': 978510, 'CM044030.1': 116599079, 'CM044029.1': 120112306, 'CM044035.1': 94665960, 'CM044044.1': 68840049, 'JAMZQU010000040.1': 1004403, 'CM044039.1': 84098834, 'CM044043.1': 66887186, 'JAMZQU010000028.1': 2364483, 'CM044027.1': 134449225, 'JAMZQU010000041.1': 798411, 'CM044048.1': 15888388, 'JAMZQU010000044.1': 257824, 'CM044047.1': 181396558, 'JAMZQU010000042.1': 396847, 'JAMZQU010000063.1': 39332, 'CM044031.1': 110860331, 'CM044041.1': 81974853, 'CM044042.1': 79872026, 'JAMZQU010000052.1': 155001, 'JAMZQU010000020.1': 556674, 'CM044046.1': 38373391, 'JAMZQU010000005.1': 1119838, 'CM044020.1': 243824586, 'CM044026.1': 138041218, 'CM044040.1': 83664602, 'JAMZQU010000064.1': 70561, 'JAMZQU010000055.1': 1595498, 'JAMZQU010000011.1': 711552, 'JAMZQU010000059.1': 115016, 'JAMZQU010000062.1': 1250, 'CM044028.1': 127419151, 'JAMZQU010000058.1': 54412, 'CM044022.1': 221584838}
min_list ={'CM044036.1': 16734, 'JAMZQU010000060.1': 1306, 'CM044033.1': 7925, 'CM044034.1': 4240, 'CM044021.1': 23310, 'CM044045.1': 13582, 'JAMZQU010000061.1': 19543, 'CM044023.1': 13388, 'JAMZQU010000004.1': 1099405, 'CM044024.1': 1967266, 'JAMZQU010000026.1': 185835, 'CM044025.1': 1121194, 'CM044037.1': 22354, 'JAMZQU010000039.1': 94666, 'JAMZQU010000034.1': 78239, 'JAMZQU010000025.1': 27378, 'CM044032.1': 74002, 'CM044038.1': 231641, 'JAMZQU010000054.1': 1587, 'JAMZQU010000012.1': 16316, 'CM044030.1': 9897, 'CM044029.1': 33688, 'CM044035.1': 10629, 'CM044044.1': 69880, 'JAMZQU010000040.1': 27950, 'CM044039.1': 20737, 'CM044043.1': 13087, 'JAMZQU010000028.1': 87594, 'CM044027.1': 4553, 'JAMZQU010000041.1': 69335, 'CM044048.1': 335911, 'JAMZQU010000044.1': 133711, 'CM044047.1': 6352, 'JAMZQU010000042.1': 396847, 'JAMZQU010000063.1': 39332, 'CM044031.1': 7567, 'CM044041.1': 19935, 'CM044042.1': 7036, 'JAMZQU010000052.1': 74185, 'JAMZQU010000020.1': 52, 'CM044046.1': 17721, 'JAMZQU010000005.1': 106660, 'CM044020.1': 21310, 'CM044026.1': 381664, 'CM044040.1': 3350, 'JAMZQU010000064.1': 37806, 'JAMZQU010000055.1': 12356, 'JAMZQU010000011.1': 23079, 'JAMZQU010000059.1': 2867, 'JAMZQU010000062.1': 1250, 'CM044028.1': 13222, 'JAMZQU010000058.1': 29743, 'CM044022.1': 12745}

chromosomes = ['CM044020.1', 'CM044021.1', 'CM044022.1', 'CM044023.1', 'CM044024.1', 'CM044025.1', 'CM044026.1', 'CM044027.1', 'CM044028.1', 'CM044029.1', 'CM044030.1', 'CM044031.1', 'CM044032.1', 'CM044033.1', 'CM044034.1', 'CM044035.1', 'CM044036.1', 'CM044037.1', 'CM044038.1', 'CM044039.1', 'CM044040.1', 'CM044041.1', 'CM044042.1', 'CM044043.1', 'CM044044.1', 'CM044045.1', 'CM044046.1', 'CM044047.1', 'CM044048.1', 'JAMZQU010000004.1', 'JAMZQU010000005.1', 'JAMZQU010000011.1', 'JAMZQU010000012.1', 'JAMZQU010000020.1', 'JAMZQU010000025.1', 'JAMZQU010000026.1', 'JAMZQU010000028.1', 'JAMZQU010000034.1', 'JAMZQU010000039.1', 'JAMZQU010000040.1', 'JAMZQU010000041.1', 'JAMZQU010000042.1', 'JAMZQU010000044.1', 'JAMZQU010000052.1', 'JAMZQU010000054.1', 'JAMZQU010000055.1', 'JAMZQU010000058.1', 'JAMZQU010000059.1', 'JAMZQU010000060.1', 'JAMZQU010000061.1', 'JAMZQU010000062.1', 'JAMZQU010000063.1', 'JAMZQU010000064.1']
chromosomes = [c for c in chromosomes if 'CM' in c]

def chromosome_offset(target_ch):
    output = 0
    for ch in chromosomes:
        if ch == target_ch:
            continue
        output+= max_list[ch]
    return output

if __name__ == '__main__':
    data = open("../data/male_data.txt").read().strip().split("\n")
    data = [d.split("\t") for d in data]
    data = [a[0:2]+[b for b in a[2].split(";") if 'VDB' in b] for a in data]
    data = [a for a in data if len(a) == 3]
    data = [a[0:2]+[a[2].replace('VDB=', '')] for a in data]
    data = [a[:2]+[float(a[2])] for a in data]



    plt.figure(figsize=(12, 6))

    plt.xlabel("Chromosome")
    plt.ylabel("-log10(p-value)")
    offset = 0
    for i, chromosome in enumerate(chromosomes):
        print(f"{chromosome}")
        chromosome_data = open(f"../data/chromosomes/{chromosome}.txt").read().strip().split("\n")
        chromosome_data = [a.split("\t") for a in chromosome_data]
        X = []
        Y = []
        maximum = 0
        for a in chromosome_data:
            X.append(int(a[1]) + offset)
            #X.append(int(a[1]))
            Y.append(-1 * np.log10(float(a[2])))
            if int(a[1]) > maximum:
                maximum = int(a[1])
        offset += maximum
        plt.scatter(X, Y, s=0.5)
        plt.savefig(f"../figs/Manhattan-complete-{i}.png")
